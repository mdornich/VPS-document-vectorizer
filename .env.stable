# Stable Apps Document Vectorizer Configuration
# Conservative settings optimized for stability and memory management

# Google Drive Configuration
GOOGLE_DRIVE_FOLDER_ID=your_google_drive_folder_id_here
GOOGLE_CREDENTIALS_PATH=config/credentials.json
GOOGLE_TOKEN_PATH=config/token.json

# Supabase Configuration  
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_service_role_secret_key

# OpenAI Configuration
OPENAI_API_KEY=sk-your-openai-api-key

# RATE LIMITING - CRITICAL FOR COST CONTROL AND STABILITY
RATE_LIMIT_ENABLED=true
MAX_REQUESTS_PER_MINUTE=8          # Reduced from 10 for better stability
MAX_REQUESTS_PER_HOUR=80          # Reduced from 100  
MAX_REQUESTS_PER_DAY=800          # Reduced from 1000
MAX_DAILY_COST_USD=10.00          # Keep same daily limit
COST_PER_EMBEDDING=0.0001         # OpenAI text-embedding-3-small cost
COST_PER_COMPLETION=0.01          # Conservative completion cost estimate

# Processing Configuration - CONSERVATIVE SETTINGS
MONITOR_INTERVAL=300              # 5 minutes instead of 60s (much more conservative)
BATCH_SIZE=5                      # Reduced from 10 to lower memory pressure
CHUNK_SIZE=300                    # Reduced from 400 for smaller memory footprint
CHUNK_OVERLAP=50                  # Reduced from 100
MAX_RETRIES=3                     # Keep same retry count
TEMP_DOWNLOAD_DIR=/app/data/temp  # Use persistent volume instead of /tmp

# Memory Management Settings
PYTHON_GC_COLLECT=1              # Enable aggressive garbage collection
OMP_NUM_THREADS=2                # Limit OpenMP threads
MALLOC_TRIM_THRESHOLD_=10000     # More aggressive memory trimming
MALLOC_ARENA_MAX=2               # Limit malloc arenas

# Document Processing Limits
MAX_FILE_SIZE_MB=50              # File size limit in MB
MAX_PDF_PAGES=1000              # Maximum PDF pages to process
MAX_EXCEL_ROWS=100000           # Maximum Excel rows to process

# Dashboard Configuration
DASHBOARD_PORT=5555              # Internal port (mapped to 8001 externally)

# Table Names
SUPABASE_DOCUMENTS_TABLE=documents
SUPABASE_METADATA_TABLE=document_metadata  
SUPABASE_ROWS_TABLE=document_rows

# Logging Configuration
LOG_LEVEL=INFO                   # INFO level for production
LOG_FORMAT=json                  # Structured logging

# Email Alert Configuration (Optional)
ALERT_EMAIL_ENABLED=false        # Disable by default
ALERT_EMAIL_FROM=alerts@yourdomain.com
ALERT_EMAIL_TO=admin@yourdomain.com
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Health Check Configuration
HEALTH_CHECK_ENABLED=true        # Enable health checks
HEALTH_CHECK_INTERVAL=30         # Check every 30 seconds

# Security Settings
ALLOWED_HOSTS=localhost,127.0.0.1,your_server_ip_here
CORS_ENABLED=false              # Disable CORS for security

# Performance Tuning
GOOGLE_DRIVE_CACHE_DURATION=120  # Cache Drive API calls for 2 minutes
GOOGLE_DRIVE_RATE_LIMIT=10      # 10 API calls per second max
VECTOR_BATCH_SIZE=100           # Vectors per batch insert
CONNECTION_POOL_SIZE=5          # Database connection pool